@model DotnetCoreJQuery.Models.CitiesInfo
@{
    ViewData["Title"] = "Index";
}
<div class="row">
    <div class="col-md-12">
        <h1>Country Sate City</h1>
        <hr />
        <div class="form-group mt-2">
            <div class="row">
                <div class="col-md-3">Country</div>
                <div class="col-md-9">
                    
                    <select id="ddlCountry" class="form-control" onchange="fnStateList()">
                    <option value="">Select country</option>
                    @foreach(var item in Model.CountryInfoList){
                    <option value="@item.CId">@item.CName</option>
                    }
                    </select>
                    

                  @*  <select id="ddlCountry" class="form-control" asp-items="@(new SelectList(Model.CountryInfoList,"CId","CName"))"
                            onchange="fnStateList()"></select>*@
                </div>
            </div>
        </div>
        <div class="form-group mt-2">
            <div class="row">
                <div class="col-md-3">State</div>
                <div class="col-md-9">
                    <select aria-label="Select Sate" id="ddlState" class="form-control" onchange="fnCityList()">
                        <option value="">Select state</option>
                       @* <option value="">Select state</option>
                        <option value="1">Bihar</option>
                        <option value="1">UP</option>
                        <option value="1">Punjab</option>*@
                    </select>
                </div>
            </div>
        </div>
        <div class="form-group mt-2">
            <div class="row">
                <div class="col-md-3">Cities</div>
                <div class="col-md-9">
                    <select aria-label="Select city" id="ddlCities" class="form-control">
                        <option value="">Select Cities</option>
                       @* <option value="">Select Cities</option>
                        <option value="1">Delhi</option>
                        <option value="1">Patna</option>
                        <option value="1">Darbhanga</option>*@
                    </select>
                </div>
            </div>
        </div>

    </div>
</div>
<script src="~/js/jquery-3.7.1.min.js"></script>
<script type="text/javascript" asp-append-version="true">
    function fnStateList() {
        var StateName = $("#ddlState");
        StateName.empty();
        $.ajax({
            type: "POST",
            url: "@Url.Action("StateData","Locations")",
            data: { cid: $("#ddlCountry").val() },
            dataType: "json",
            success:function(result){
                console.log(result);
                    StateName.append(`<option value="">Select State</option>`);
                $.each(result.stateInfoList, function (index, raj) {
                    StateName.append(`<option value="${raj.sId}">${raj.sName}</option>`);
                    //alert(result.state)
                })
            },
            Error:function(req,status,error){

            }
        });
    }

    function fnCityList() {
        var CityName = $("#ddlCities");
        CityName.empty();
        $.ajax({
            type: "POST",
            url: "@Url.Action("CityData","Locations")",
            data: { sid: $("#ddlState").val() },
            dataType: "json",
            success: function (result) {
                console.log(result);
                CityName.append(`<option value="">Select city</option>`);
                $.each(result.cityInfoList, function (index, raj) {
                    CityName.append(`<option value="${raj.cityId}">${raj.cityName}</option>`);
                })
            },
            Error: function (req, status, error) {

            }
        });
    }
</script>



